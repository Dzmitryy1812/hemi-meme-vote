<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
   <title>Meme Voting - HEMI</title>
   <title>HEMIMEME - Meme Gallery</title>
   <script src="https://cdn.tailwindcss.com"></script>
   <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
   <style>
     .meme-card {
       transition: transform 0.3s ease, box-shadow 0.3s ease;
     }
     .meme-card:hover {
       transform: translateY(-5px);
     }
     #uploadModal {
       transition: opacity 0.3s ease;
     }
   </style>
 </head>
 <body class="bg-gray-100 text-gray-800">
 
   <div class="max-w-4xl mx-auto p-6">
     <h1 class="text-4xl font-bold mb-4 text-center">HEMI Meme Voting</h1>
 
     <!-- Stats -->
     <div class="flex justify-around mb-6">
       <div>ðŸ“ˆ Total Votes: <span id="totalVotes">0</span></div>
       <div>ðŸ“· Total Memes: <span id="totalMemes">0</span></div>
 <body class="bg-orange-50 text-orange-900 font-sans min-h-screen">
 
   <!-- Header -->
   <header class="bg-orange-600 text-white px-4 py-4 flex justify-between items-center shadow sticky top-0 z-10">
     <div class="flex items-center gap-2">
       <img src="https://i.imgur.com/SyOVYBY.jpeg" alt="HEMIMEME Logo" class="h-8 w-auto rounded-full">
       <h1 class="text-xl font-bold hidden sm:block">
         <i class="fas fa-images"></i> HEMIMEME
       </h1>
     </div>
 
     <!-- Upload Button -->
     <div class="text-center mb-4">
       <button onclick="document.getElementById('uploadModal').classList.remove('hidden')"
               class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
         âž• Upload Meme
     <div class="flex items-center gap-2">
       <button id="connectButton" class="bg-white text-orange-600 px-4 py-2 rounded shadow hover:bg-orange-100 transition flex items-center">
         <i class="fas fa-wallet mr-2"></i>
         <span class="hidden sm:inline">Connect Wallet</span>
       </button>
       <button id="uploadButton" class="bg-orange-500 text-white px-4 py-2 rounded shadow hover:bg-orange-600 transition flex items-center">
         <i class="fas fa-upload mr-2"></i>
         <span class="hidden sm:inline">Upload Meme</span>
       </button>
     </div>
   </header>
 
   <!-- Main -->
   <main class="max-w-5xl mx-auto py-8 px-4">
     <div class="flex justify-between items-center mb-6">
       <h2 class="text-2xl font-bold text-orange-800">Latest Memes</h2>
       <div id="stats" class="text-sm text-orange-600">
         <span id="memeCount">0</span> memes â€¢ <span id="totalVotes">0</span> votes
       </div>
     </div>
 
     <!-- Meme Grid -->
     <div id="memeGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
   </div>
     <div id="memeGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
       <div class="text-center py-10">
         <i class="fas fa-spinner fa-spin text-3xl text-orange-400 mb-2"></i>
         <p>Loading memes...</p>
       </div>
     </div>
   </main>
 
   <!-- Footer -->
   <footer class="bg-orange-600 text-white py-4 mt-8">
     <div class="container mx-auto px-4 text-center text-sm">
       <p>HEMIMEME Â© 2025 â€¢ All memes belong to their respective authors</p>
     </div>
   </footer>
 
   <!-- Upload Modal -->
   <div id="uploadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
     <div class="bg-white p-6 rounded shadow-md w-full max-w-md">
       <h2 class="text-xl font-semibold mb-4">Upload Your Meme</h2>
       <form id="memeForm">
         <input id="memeTitle" type="text" placeholder="Meme title"
                class="w-full mb-2 px-3 py-2 border rounded" required />
         <input id="memeUrl" type="url" placeholder="Image URL"
                class="w-full mb-2 px-3 py-2 border rounded" required />
         <input id="discordNick" type="text" placeholder="Your Discord Nick (optional)"
                class="w-full mb-4 px-3 py-2 border rounded" />
         <div class="flex justify-between">
           <button type="submit"
                   class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
             Upload Meme
           </button>
           <button type="button" onclick="document.getElementById('uploadModal').classList.add('hidden')"
                   class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded">
             Cancel
   <div id="uploadModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-20">
     <div class="bg-white rounded-lg p-6 w-full max-w-md">
       <div class="flex justify-between items-center mb-4">
         <h3 class="text-xl font-bold text-orange-800">Upload New Meme</h3>
         <button id="closeModal" class="text-orange-600 hover:text-orange-800">
           <i class="fas fa-times"></i>
         </button>
       </div>
 
       <form id="memeForm" class="space-y-4">
         <div>
           <label class="block text-sm font-medium text-orange-700">Meme Title</label>
           <input type="text" id="memeTitle" required class="mt-1 block w-full rounded-md border-orange-300 shadow-sm focus:border-orange-500 focus:ring-orange-500">
         </div>
         <div>
           <label class="block text-sm font-medium text-orange-700">Image URL</label>
           <input type="url" id="memeUrl" required class="mt-1 block w-full rounded-md border-orange-300 shadow-sm focus:border-orange-500 focus:ring-orange-500" placeholder="https://i.imgur.com/example.jpg">
         </div>
         <div>
           <label class="block text-sm font-medium text-orange-700">Your Discord</label>
           <input type="text" id="discordNick" class="mt-1 block w-full rounded-md border-orange-300 shadow-sm focus:border-orange-500 focus:ring-orange-500" placeholder="username#1234 (optional)">
         </div>
         <div class="flex justify-end space-x-3 pt-2">
           <button type="button" id="cancelUpload" class="px-4 py-2 text-sm text-orange-600 hover:text-orange-800">Cancel</button>
           <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition">
             <i class="fas fa-upload mr-1"></i> Upload
           </button>
         </div>
       </form>
 @@ -56,70 +100,150 @@ <h2 class="text-xl font-semibold mb-4">Upload Your Meme</h2>
 
   <script>
     let memes = [];
     const memeGrid = document.getElementById("memeGrid");
     let isConnected = false;
 
     const fallbackMemes = [
       { id: 1, title: "Distracted Boyfriend", imageUrl: "https://i.imgflip.com/1bij.jpg", votes: 42, author: "memelord#1337" },
       { id: 2, title: "Change My Mind", imageUrl: "https://i.imgflip.com/9vct.jpg", votes: 35, author: "discord_user#4242" },
       { id: 3, title: "Drake Hotline Bling", imageUrl: "https://i.imgflip.com/30b1gx.jpg", votes: 28, author: null }
     ];
 
     async function loadMemes() {
       try {
         const response = await fetch('http://localhost:3000/memes');
         if (!response.ok) throw new Error('Server error');
         memes = await response.json();
         memes = memes.map((meme, index) => ({
           id: index + 1,
           title: meme.title || `Meme #${index + 1}`,
           imageUrl: meme.url,
           votes: meme.votes || 0,
           author: meme.author || null
         }));
       } catch (error) {
         console.error("Loading error:", error);
         memes = fallbackMemes;
       }
       updateStats();
       renderMemes();
     }
 
     function updateStats() {
       document.getElementById("totalVotes").textContent = memes.reduce((sum, m) => sum + m.votes, 0);
       document.getElementById("totalMemes").textContent = memes.length;
       document.getElementById('memeCount').textContent = memes.length;
       document.getElementById('totalVotes').textContent = memes.reduce((sum, meme) => sum + meme.votes, 0);
     }
 
     function renderMemes() {
       const grid = document.getElementById("memeGrid");
       grid.innerHTML = "";
 
       memes.forEach((meme, index) => {
         const card = document.createElement("div");
         card.className = "bg-white rounded shadow p-4 flex flex-col";
 
         card.innerHTML = `
           <img src="${meme.imageUrl}" alt="${meme.title}" class="w-full h-48 object-cover rounded mb-3">
           <h3 class="text-lg font-semibold">${meme.title}</h3>
           <p class="text-sm text-gray-500 mb-2">By ${meme.author || "Anonymous"}</p>
           <div class="flex justify-between items-center">
             <span>ðŸ”¥ ${meme.votes} votes</span>
             <button class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded"
                     onclick="voteMeme(${index})">Vote</button>
       if (memes.length === 0) {
         memeGrid.innerHTML = '<div class="col-span-full text-center py-10 text-orange-600"><i class="fas fa-meh"></i> No memes available</div>';
         return;
       }
       memeGrid.innerHTML = '';
       memes.forEach(meme => {
         const div = document.createElement("div");
         div.className = "bg-white rounded-lg shadow-md overflow-hidden meme-card hover:shadow-lg";
         div.innerHTML = `
           <div class="relative">
             <img src="${meme.imageUrl}" alt="${meme.title}" 
                  class="w-full h-64 object-cover hover:opacity-90 transition"
                  onerror="this.src='https://via.placeholder.com/400x300?text=Image+Error'">
             <div class="absolute top-2 right-2 bg-orange-600 text-white text-xs px-2 py-1 rounded-full">
               #${meme.id}
             </div>
           </div>
           <div class="p-4">
             <h3 class="text-sm font-semibold truncate" title="${meme.title}">${meme.title}</h3>
             <p class="text-xs text-orange-500 mt-1 truncate" title="${meme.author || 'Anonymous'}">
               <i class="fab fa-discord mr-1"></i> ${meme.author || 'Anonymous'}
             </p>
             <div class="flex justify-between items-center mt-2">
               <span class="text-xs text-orange-600 font-medium">
                 <i class="fas fa-heart mr-1"></i> ${meme.votes}
               </span>
               <button onclick="voteMeme(${meme.id})"
                       class="text-sm bg-orange-600 text-white px-3 py-1 rounded hover:bg-orange-700 transition flex items-center"
                       ${!isConnected ? 'disabled title="Connect wallet first"' : ''}>
                 <i class="fas fa-vote-yea mr-1"></i> Vote
               </button>
             </div>
           </div>
         `;
         grid.appendChild(card);
         memeGrid.appendChild(div);
       });
     }
 
     function voteMeme(index) {
       memes[index].votes++;
       updateStats();
       renderMemes();
     async function connectWallet() {
       if (window.ethereum) {
         try {
           const provider = new ethers.providers.Web3Provider(window.ethereum);
           await provider.send("eth_requestAccounts", []);
           const signer = provider.getSigner();
           const address = await signer.getAddress();
           document.getElementById("connectButton").innerHTML = `
             <i class="fas fa-check-circle mr-1"></i>
             <span class="hidden sm:inline">${address.slice(0, 6)}...${address.slice(-4)}</span>
           `;
           isConnected = true;
           document.querySelectorAll('#memeGrid button').forEach(btn => {
             btn.disabled = false;
             btn.title = '';
           });
         } catch (error) {
           console.error("Wallet error:", error);
           alert("Failed to connect wallet");
         }
       } else {
         alert("Please install MetaMask or another wallet");
       }
     }
 
     document.getElementById("memeForm").addEventListener("submit", (e) => {
       e.preventDefault();
 
       const title = document.getElementById("memeTitle").value.trim();
       const imageUrl = document.getElementById("memeUrl").value.trim();
       const author = document.getElementById("discordNick").value.trim() || "Anonymous";
 
       if (!title || !imageUrl) {
         alert("Please fill in the required fields.");
     async function voteMeme(memeId) {
       if (!isConnected) {
         alert("Connect your wallet first");
         return;
       }
       try {
         const meme = memes.find(m => m.id === memeId);
         if (meme) {
           const btn = document.querySelector(`button[onclick="voteMeme(${memeId})"]`);
           btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
           btn.disabled = true;
           await new Promise(resolve => setTimeout(resolve, 800));
           meme.votes += 1;
           updateStats();
           renderMemes();
         }
       } catch (error) {
         alert("Vote failed");
       }
     }
 
       const newMeme = {
         title,
         imageUrl,
         votes: 0,
         author
       };
     document.getElementById("connectButton").addEventListener("click", connectWallet);
     document.getElementById("uploadButton").addEventListener("click", () => {
       document.getElementById("uploadModal").classList.remove("hidden");
     });
     document.getElementById("cancelUpload").addEventListener("click", () => {
       document.getElementById("uploadModal").classList.add("hidden");
     });
     document.getElementById("closeModal").addEventListener("click", () => {
       document.getElementById("uploadModal").classList.add("hidden");
     });
 
       memes.unshift(newMeme);
     document.getElementById("memeForm").addEventListener("submit", async (e) => {
       e.preventDefault();
       const title = document.getElementById("memeTitle").value;
       const url = document.getElementById("memeUrl").value;
       const author = document.getElementById("discordNick").value;
       const newMeme = { title, url, votes: 0, author };
       memes.unshift({ id: memes.length + 1, ...newMeme });
       updateStats();
       renderMemes();
 
       document.getElementById("memeForm").reset();
       document.getElementById("uploadModal").classList.add("hidden");
       document.getElementById("memeForm").reset();
     });
 
     // Initial render
     updateStats();
     renderMemes();
     loadMemes();
   </script>
 </body>
 </html>
